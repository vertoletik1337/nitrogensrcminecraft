name: NitrogenFix
on: [push]
jobs:
  build:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v4
      - uses: microsoft/setup-msbuild@v2
      - uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
      - name: Build
        shell: powershell
        run: |
          $env:INCLUDE += ";$($env:JAVA_HOME)\include;$($env:JAVA_HOME)\include\win32"
          $dll = Get-ChildItem -Filter "NitrogenDLL.vcxproj" -Recurse | Select-Object -First 1
          if ($dll) { msbuild $($dll.FullName) /p:Configuration=Release /p:Platform=x64 }
          $inj = Get-ChildItem -Filter "*.csproj" -Recurse | Select-Object -First 1
          if ($inj) { dotnet restore $($inj.FullName); msbuild $($inj.FullName) /p:Configuration=Release /p:Platform=AnyCPU }
      - uses: actions/upload-artifact@v4
        with:
          name: Nitrogen_Ready
          path: "**/Release/*"
